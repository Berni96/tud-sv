
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1.3 - Anwendungsbeispiel &#8212; SV-book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.1 - Sweep" href="../Thema-2-Messung%20der%20%C3%9Cbertragungsfunktion/2.1%20-%20Sweep.html" />
    <link rel="prev" title="1.2 - IIR-Filterentwurf" href="1.2%20-%20IIR%20Filterentwurf.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">SV-book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Einf%C3%BChrung%20in%20Python/0.1%20-%20Installationsanleitung.html">
                    0.1 - Installationsanleitung
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Einführung in Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Einf%C3%BChrung%20in%20Python/0.2%20-%20Einf%C3%BChrung.html">
   0.2 - Einführung
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thema-1-Filter
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.1%20-%20FIR%20Filterentwurf.html">
   1.1 - FIR Filterentwurf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.2%20-%20IIR%20Filterentwurf.html">
   1.2 - IIR-Filterentwurf
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1.3 -  Anwendungsbeispiel
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thema-2-Messung der Übertragungsfunktion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Thema-2-Messung%20der%20%C3%9Cbertragungsfunktion/2.1%20-%20Sweep.html">
   2.1 - Sweep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Thema-2-Messung%20der%20%C3%9Cbertragungsfunktion/2.2%20-%20LPC.html">
   2.2 - Linear Predictive Coding
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thema-3-Analyse nichtstationärer Signale
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Thema-3-Analyse%20nichtstation%C3%A4rer%20Signale/3.1%20-%20STFT.html">
   3.1 - Short Time Fourier Transformation
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/Berni96/tud-sv/main?urlpath=tree/sv_book/Einführung%20in%20Python/Thema-1-Filter/1.3 - Anwendungsbeispiel.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/Berni96/tud-sv/blob/main/sv_book/Einführung%20in%20Python/Thema-1-Filter/1.3 - Anwendungsbeispiel.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Berni96/tud-sv"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Berni96/tud-sv/issues/new?title=Issue%20on%20page%20%2FThema-1-Filter/1.3 - Anwendungsbeispiel.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Thema-1-Filter/1.3 - Anwendungsbeispiel.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inhalt">
   Inhalt
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-von-audiodateien">
     1.1 Import von Audiodateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#abspielen-von-audiodateien">
     1.2 Abspielen von Audiodateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#signale-bearbeiten-storsignal-erstellen">
     1.3 Signale bearbeiten / Störsignal erstellen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-mittels-idft">
     2.1 FIR-Filter mittels IDFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-mittels-firwin">
     2.2 FIR-Filter mittels
     <strong>
      firwin()
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#butterworth-filter">
     3.1 Butterworth Filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chebyshev-filter">
     3.2 Chebyshev Filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>1.3 -  Anwendungsbeispiel</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inhalt">
   Inhalt
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-von-audiodateien">
     1.1 Import von Audiodateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#abspielen-von-audiodateien">
     1.2 Abspielen von Audiodateien
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#signale-bearbeiten-storsignal-erstellen">
     1.3 Signale bearbeiten / Störsignal erstellen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-mittels-idft">
     2.1 FIR-Filter mittels IDFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-mittels-firwin">
     2.2 FIR-Filter mittels
     <strong>
      firwin()
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#butterworth-filter">
     3.1 Butterworth Filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chebyshev-filter">
     3.2 Chebyshev Filter
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="anwendungsbeispiel">
<h1>1.3 -  Anwendungsbeispiel<a class="headerlink" href="#anwendungsbeispiel" title="Permalink to this headline">#</a></h1>
<a class="reference internal image-reference" href="../_images/audio.jpg"><img alt="../_images/audio.jpg" src="../_images/audio.jpg" style="width: 400px;" /></a>
<p>Diese Notebook baut auf die beiden Vorherigen auf, in denen der FIR und IIR Filterentwurf mit verschiedenen Methoden ausführlich behandelt wurde.</p>
<p>Im Folgenden soll ein Praxisbeispiel für einer Filterantwendung mit konkreten Randbedingungen bearbeitet werden. Auf ein Audiosignal (akustik.wav, zu finden im Ordner ‘data’) sollen zunächst Störsignale aufaddiert werden, die anschließend mit verschiedenen Filtern wieder entfernt werden, um das ursprüngliche Signal wiederherzustellen. Dabei sollen die Vor- und Nachteile der verschiedenen Filtertypen aufgezeigt werden.</p>
<p>Außerdem sollen einige grundlegende Python Module zur Verarbeitung speziell von Audiosignalen vorgestellt und angewendet werden.</p>
<section id="inhalt">
<h2>Inhalt<a class="headerlink" href="#inhalt" title="Permalink to this headline">#</a></h2>
<table style="width:256px; border: 1px solid black; display: inline-block">
  <tr>
    <td  style="text-align:right" width=64px><img src="img/IMG-Python.png" style="float:left"></td>
      <td style="text-align:left" width=256px>
          <a style="color:black; font-size:14px; font-weight:bold; text-decoration:none" href='#intro'>1. Audiosignale in Python</a>
    </td>
  </tr>  
    <tr>
    <td  style="text-align:right" width=64px><img src="img/IMG-fir.jpg" style="float:left"></td>
      <td style="text-align:left" width=256px>
          <a style="color:black; font-size:14px; font-weight:bold; text-decoration:none" href='#fir'>2. FIR-Filterung</a>
    </td>
  </tr>  
    <tr>
    <td  style="text-align:right" width=64px><img src="img/IMG-iir.jpg" style="float:left"></td>
      <td style="text-align:left" width=256px>
          <a style="color:black; font-size:14px; font-weight:bold; text-decoration:none" href='#iir'>3. IIR-Filterung</a>
    </td>
  </tr>
</table>
<hr class="docutils" />
<p><a id='intro'></a><div><img alt="../_images/IMG-Python1.png" src="../_images/IMG-Python1.png" /><h2 style="position: relative; top: 6px; left: 6px">1. Audiosignale in Python</h2></div></p>
<section id="import-von-audiodateien">
<h3>1.1 Import von Audiodateien<a class="headerlink" href="#import-von-audiodateien" title="Permalink to this headline">#</a></h3>
<p>Um ein Audiosignal zu bearbeiten, muss es zunächst geladen/importiert werden. Dafür werden drei verschiedene Methoden vorgestellt:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/akustik.wav&#39;</span>

<span class="c1"># 1. wavfile:</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">wavfile</span>
<span class="n">sr</span><span class="p">,</span> <span class="n">audio</span> <span class="o">=</span> <span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="c1"># 2. wave:</span>
<span class="kn">import</span> <span class="nn">wave</span>
<span class="n">wf</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">audio</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">readframes</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="c1"># 3. librosa:</span>
<span class="kn">import</span> <span class="nn">librosa</span>
<span class="n">audio</span><span class="p">,</span> <span class="n">sr</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>In diesem Notebook verwenden wir die erste Option <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html?highlight=wavfile#module-scipy.io.wavfile"><code class="docutils literal notranslate"><span class="pre">wavfile()</span></code></a>, da es schon in dem Modul <code class="docutils literal notranslate"><span class="pre">scipy</span></code> integriert und somit installiert ist. Schauen Sie sich nun die Audioaufnahme <code class="docutils literal notranslate"><span class="pre">data/akustik.wav</span></code> im Zeit- und Frequenzbereich an. Importieren Sie dafür zuerst die dafür notwendigen Module:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importieren Sie aus scipy die Teilbibliothek &quot;fftpack&quot; </span>
<span class="c1"># Importieren Sie aus  scipy.io die Teilbibliothek &quot;wavfile&quot;</span>
<span class="c1"># Importieren Sie aus matplotlib die Teilbibliothek &quot;pyplot&quot; mit dem Alias &quot;plt&quot;</span>
<span class="c1"># Importieren Sie das numpy-Modul mit dem Alias &quot;np&quot;</span>

<span class="p">[</span><span class="o">..</span><span class="p">]</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Beispiel: Audiodatei einlesen und visualisieren</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Datei einlesen </span>
<span class="n">fs_Hz</span><span class="p">,</span> <span class="n">audioSignal</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Lesen Sie Sample-Rate und das Audiosignal in Arrayform ein </span>
<span class="n">audioSignal</span> <span class="o">=</span> <span class="n">audioSignal</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">audioSignal</span><span class="p">))</span>   <span class="c1"># Normalisierung</span>

<span class="c1"># Initiale Daten</span>
<span class="n">signalLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">audioSignal</span><span class="p">)</span>                 <span class="c1"># Länge des Audiosignals</span>
<span class="n">T_s</span> <span class="o">=</span> <span class="n">signalLength</span><span class="o">/</span><span class="n">fs_Hz</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs_Hz</span>              <span class="c1"># Zeit</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_s</span><span class="p">,</span> <span class="n">signalLength</span><span class="p">)</span>         <span class="c1"># Zeitbereich</span>
<span class="n">f_Hz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Frequenzbereich</span>

<span class="c1"># Spectrale</span>
<span class="n">audioSignal_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>   <span class="c1"># ToDo: Führen Sie eine FFT des Audiosignals durch</span>


<span class="c1"># Graphische Darstellung</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signalamplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">audioSignal</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> Punkte FFT des Audiosignals&#39;</span> <span class="o">%</span><span class="k">signalLength</span>)
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [Hz]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;|X(f)|&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">audioSignal_fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="abspielen-von-audiodateien">
<h3>1.2 Abspielen von Audiodateien<a class="headerlink" href="#abspielen-von-audiodateien" title="Permalink to this headline">#</a></h3>
<p>Die Ausgabe von Audiosignalen kann in Python auch mit unterschiedlichen externen Modulen realisiert werden. Falls Sie das Modul nicht installiert haben, können Sie dies via <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">&quot;module&quot;</span></code> durchführen. Hier werden Ihnen drei mögliche Module mit Ihren individuellen Vorzügen vorgestellt:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/playsound/"><code class="docutils literal notranslate"><span class="pre">playsound</span></code></a><br />
Das PlaySound-Modul ist ein plattformübergreifendes Modul, das Audiodateien abspielen kann.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">playsound</span> <span class="kn">import</span> <span class="n">playsound</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">playsound</span><span class="p">(</span><span class="s1">&#39;data/akustik.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://ipython.org/ipython-doc/dev/api/generated/IPython.display.html"><code class="docutils literal notranslate"><span class="pre">IPython.display</span></code></a><br />
Mit diesem Modul wird die Audiodatei mit einem Audioplayer geöffnet, der anschließend per Klick gestartet werden kann:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">ipd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="s1">&#39;data/akustik.wav&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://simpleaudio.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">simpleaudio</span></code></a><br />
Das Modul ermöglicht es, sowohl wav-Dateien als auch NumPy-Arrays abgespielt zu können. Diese Eigenschaft ist für dieses Notebook sehr nützlich, weshalb im Weiteren auf <code class="docutils literal notranslate"><span class="pre">simpleaudio</span></code> zurückgegriffen wird.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">simpleaudio</span> <span class="k">as</span> <span class="nn">sa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Beispiel: wav-Dateien abspielen</span>

<span class="c1"># Datei einlesen</span>
<span class="n">wave_obj</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">WaveObject</span><span class="o">.</span><span class="n">from_wave_file</span><span class="p">(</span><span class="s1">&#39;data/akustik.wav&#39;</span><span class="p">)</span>

<span class="c1"># abspielen</span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="n">wave_obj</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Beispiel: NumPy-Arrays (Audiosignal) abspielen</span>

<span class="c1"># Datei ablesen </span>
<span class="n">fs_Hz</span><span class="p">,</span> <span class="n">audioSignal</span> <span class="o">=</span> <span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;data/akustik.wav&#39;</span><span class="p">)</span>

<span class="c1"># abspielen</span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">play_buffer</span><span class="p">(</span><span class="n">audioSignal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">)</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Beispiel: NumPy-Arrays (Sinussignal) abspielen</span>

<span class="c1"># Sinussignal erzeugen</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">440</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t_s</span><span class="p">)</span>

<span class="c1"># Werte im 16-Bit-Bereich konvertieren</span>
<span class="n">sound</span> <span class="o">=</span> <span class="n">sine</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">15</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sine</span><span class="p">)</span>
<span class="n">sound</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

<span class="c1"># abspielen</span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">play_buffer</span><span class="p">(</span><span class="n">sound</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="signale-bearbeiten-storsignal-erstellen">
<h3>1.3 Signale bearbeiten / Störsignal erstellen<a class="headerlink" href="#signale-bearbeiten-storsignal-erstellen" title="Permalink to this headline">#</a></h3>
<p>Wenn das Audiosignal als numpy-Array vorliegt, kann das Signal sehr leicht bearbeitet werden. Zuerst soll dafür auf die Audiodatei <code class="docutils literal notranslate"><span class="pre">akustik.wav</span></code> ein Sinus mit der Frequenz von 440 Hz addiert werden. Dadurch erhält die Audiodatei ein Störsignal, welches Sie danach wieder davon zu entfernen versuchen. Da gleich das Signal zudem gefenstert werden soll, wird noch das Modul <code class="docutils literal notranslate"><span class="pre">signal</span></code> importiert, um daraus <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.get_window.html">get_window()</a> zu verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importieren Sie aus scipy die Teilbibliotheken &quot;signal&quot; und &quot;fft&quot;</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Beispiel: Signal addieren, visualisieren und abspielen</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Datei einlesen (originales Audiosignal)</span>
<span class="n">fs_Hz</span><span class="p">,</span> <span class="n">audioSignal</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>   <span class="c1"># ToDo: lesen sie die Audiodatei &quot;akustik.wav&quot; mit dem Objekt wavfile.read() ein</span>
<span class="n">audioSignal</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>          <span class="c1"># ToDo: Normalisieren Sie das numpy-Array</span>

<span class="c1"># Initialisierung der Variablen</span>
<span class="n">fsin_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>              <span class="c1"># ToDo: Bestimmen Sie die Sinusfrequenz</span>
<span class="n">signalLength</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Bestimmen Sie die Länge des Audio-Arrays</span>
<span class="n">T_s</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                  <span class="c1"># ToDo: Bestimmen Sie die Zeitdauer der Aufnahme</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                  <span class="c1"># ToDo: Erzeugen Sie das zeitliche Array (nutzen Sie dafür np.linspace())</span>
<span class="n">f_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                 <span class="c1"># ToDo: Erzeugen Sie das Array für den Frequenzbereich (nutzen Sie dafür np.linspace())</span>

<span class="c1"># Sinussignale erstellen</span>
<span class="n">sine</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                 <span class="c1"># ToDo: Erzeugen Sie das Sinussignal mit einer Frequenz von 440 Hz im Zeitbereich</span>
<span class="n">sine_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>             <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich des Signals</span>

<span class="c1"># Graphische Darstellung</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Störsignal im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">sine</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Störsignal im Frequenzbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sine_fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des Sinussignals</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audio-Array &quot;sine&quot; in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Erzeugung eines mit Sinus gestörten Audiosignals</span>
<span class="n">corruptedAudioSignal</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Addieren Sie das Audiosignal mit dem Sinussignal (im Zeitbereich)</span>
<span class="n">corruptedAudioSignal_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>     <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich des Signals mit Störung</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal mit Störung im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal mit Störung im Frequenzbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_fft</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des gestörten Signals</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audio-Array &quot;corruptedAudioSignal&quot; in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fensterung (optional)</span>
<span class="n">window</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>      <span class="c1"># ToDo: Erzeugen Sie ein Hanning-Fenster der Länge &quot;signalLength&quot; mit signal.get_window()</span>
<span class="n">corruptedAudioSignal_windowed</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Wenden Sie das Fenster auf das Signal &quot;s&quot; an.</span>
<span class="n">corruptedAudioSignal_windowed_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich von s_windowed</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;gefenstertes Audiosignal mit Störung im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_windowed</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;gefenstertes Audiosignal mit Störung im Frequenzbereich&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_windowed_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des gefensterten Störsignals</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audio-Array &quot;s_windowed&quot; in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">corruptedAudioSignal</span></code> beziehungsweise <code class="docutils literal notranslate"><span class="pre">corruptedAudioSignal_windowed</span></code> wurde jetzt ein mit einem Sinuston gestörtes Audiosignal erzeugt. Im Folgenden wird nun versucht, mittels der in Notebook 1.1 und 1.2 kennengelernten Filter diese Störung zu filtern und wieder ein dem Original ähnliches Audiosignal zu rekonstruieren.</p>
<hr class="docutils" />
<p><a id='fir'></a><div><img alt="../_images/IMG-fir.jpg" src="../_images/IMG-fir.jpg" /><h2 style="position: relative; top: 6px; left: 6px">2. FIR-Filterung </h2></div></p>
</section>
<section id="fir-filter-mittels-idft">
<h3>2.1 FIR-Filter mittels IDFT<a class="headerlink" href="#fir-filter-mittels-idft" title="Permalink to this headline">#</a></h3>
<p>Wie in Kapitel 1.1 wird zuerst ein Bandsperrfilter mittels IDFT verwendet und entworfen, um das Sinussignal aus dem Audiosignal zu entfernen. Der Filter soll dabei eine Bandbreite von 60 Hz haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Beispiel: Entfernen von Signalen mittels selbst definierten FIR-Bandsperrfilter</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Filter</span>
<span class="n">bw_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>   <span class="c1"># ToDo: definieren Sie die Bandbreite</span>
<span class="n">fcLower_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: berechnen Sie die untere Grenzfrequenz der Bandsperre</span>
<span class="n">fcUpper_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: berechnen Sie die obere Grenzfrequenz der Bandsperre</span>
<span class="n">fftLength</span> <span class="o">=</span> <span class="mi">2048</span>

<span class="c1"># Definition des idealen Frequenzganges der Bandsperre:</span>
<span class="n">f_Hz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">fftLength</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Erzeugen Sie mit np.where einen idealen Bandsperrfilter mit Bandbreite 60 Hz</span>

<span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Berechnen Sie die Impulsantwort mittels ifft (ifft-shift nicht vergessen!)</span>


<span class="c1"># Filterkern aus der Impulsantwort ausschneiden und Fenstern:</span>
<span class="n">filterLength</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">;</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span> <span class="n">filterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">filterKernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">h</span><span class="p">[(</span><span class="n">fftLength</span> <span class="o">-</span> <span class="n">filterLength</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:(</span><span class="n">fftLength</span> <span class="o">+</span> <span class="n">filterLength</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">window</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">filterKernel</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># Frequenzgang des ist-Filters:</span>
<span class="n">H_ist</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnen Sie den Frequenzgang von filterKernel mittels FFT</span>


<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Idealer Amplitudenfrequenzgang </span><span class="se">\n</span><span class="s1"> des Bandpasses&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [Hz]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$H(e^{j\Omega})$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Maskierte und gefensterte </span><span class="se">\n</span><span class="s1"> Impulsantwort des Bandsperrfilters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sample Index k&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">filterKernel</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tatsächlicher Amplitudenfrequenzgang </span><span class="se">\n</span><span class="s1"> des Bandsperrfilters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [Hz]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$|H(e^{j\Omega})|$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_Hz</span><span class="p">,</span> <span class="n">H_ist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filterung</span>
<span class="n">corruptedAudioSignal_filtered</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Falten Sie das gestörte Signal &quot;corruptedAudioSignal&quot; mit dem Filter &quot;filterKernel&quot; </span>
<span class="n">corruptedAudioSignal_filtered_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnen Sie den Frequenzgang von corruptedAudioSignal_filtered mittels FFT</span>

<span class="c1"># Plot</span>
<span class="n">fPlot_Hz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs_Hz</span><span class="p">,</span> <span class="n">signalLength</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal nach Bandsperrfilterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signalamplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_filtered</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [Hz]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_filtered_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des mit FIR-gefilterten Signals</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fir-filter-mittels-firwin">
<h3>2.2 FIR-Filter mittels <strong>firwin()</strong><a class="headerlink" href="#fir-filter-mittels-firwin" title="Permalink to this headline">#</a></h3>
<p>Für solche Anwendungen können wir aber auch die vorhandenen Filter wie <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.firwin.html"><code class="docutils literal notranslate"><span class="pre">signal.firwin()</span></code></a> in <strong><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html"><code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></strong> direkt benutzen. Ändern Sie dabei die Ordnung (sie können dafür auch eine for-Schleife mit logarithmisch ansteigender Ordnungszahl implementieren), bis das Ergebnis dem der IDFT ähnelt. <br> <em>Hinweis</em>: die Ordnungszahl $n$ kann gerne größer 1000 sein.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Aufgabe: Entfernen von Frequenzen mittels signal.firwin() </span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># zu verwendende Parameter für firwin()</span>
<span class="n">bw_Hz</span> <span class="o">=</span> <span class="mi">60</span>                                        <span class="c1"># Bandbreite</span>
<span class="n">filterOrder</span> <span class="o">=</span> <span class="mi">5001</span>                                <span class="c1"># Ordnung</span>
<span class="n">wPass_Hz</span> <span class="o">=</span> <span class="p">[(</span><span class="n">fsin_Hz</span><span class="o">-</span><span class="n">bw_Hz</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">fsin_Hz</span><span class="o">+</span><span class="n">bw_Hz</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># Grenzfrequenzen</span>

<span class="c1"># Erzeugen des Bandsperrfilters</span>
<span class="n">h_fir</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>       <span class="c1"># ToDo: Erzeugen Sie mit signal.firwin() einen Bandsperrfilter.</span>
<span class="n">H_fir</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>       <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich des Bandpassfilters</span>

<span class="c1"># Filterung mit Fenster</span>
<span class="n">corruptedAudioSignal_filtered</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Falten Sie das gestörte Signal &quot;corruptedAudioSignal&quot; mit dem Filter &quot;h_fir&quot; </span>
<span class="n">corruptedAudioSignal_filtered_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich des gefilterten Signals</span>

<span class="c1"># Graphische Darstellung</span>
<span class="n">fPlot_Hz</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Impulsantwort des Filters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sample Nummer&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_fir</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Spektral des Filters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_fir</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal nach Bandsperrfilterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_filtered</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_filtered_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des mit firwin() gefilterten Signals</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Um einen Bandsperrfilter mit hohem Knick und engem Frequenzbereich zu erzeugen, um nur das Sinussignal zu entfernen, benötigt der FIR-Filter eine große Ordnungszahl. Das bedeutet, dass man für die Umsetzung des Filters viel Speicherplatz benötigt und einen goßen Rechenaufwand hat, was für eine niedrige Effizienz spricht.</p>
<p>Um zu analysieren, ob IIR-Filter eine bessere Alternative darstellen, wenn es um effizientes Filterdesign geht, soll nun im nächsten Kapitel dasselbe Signal <code class="docutils literal notranslate"><span class="pre">corruptedAudioSignal</span></code> bzw. <code class="docutils literal notranslate"><span class="pre">corruptedAudioSignal_windowed</span></code> mittels der in Notebook 1.2 kennengelernten Filter und Filterdesign bereinigt werden.</p>
<hr class="docutils" />
<p><a id='iir'></a><div><img alt="../_images/IMG-iir.jpg" src="../_images/IMG-iir.jpg" /><h2 style="position: relative; top: 6px; left: 6px">3. IIR-Filterung </h2></div></p>
</section>
<section id="butterworth-filter">
<h3>3.1 Butterworth Filter<a class="headerlink" href="#butterworth-filter" title="Permalink to this headline">#</a></h3>
<p>Zunächst soll ein Butterworth-Filter mit 10. Ordnung und einer Bandbreite $bw = 60$ Hz entworfen werden. Dazu wird, wie in Kapitel 1.2, das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.butter.html"><code class="docutils literal notranslate"><span class="pre">signal.butter()</span></code></a> zur Erzeugung der Filterkoeffizienten verwendet. Geben Sie sich nun aber mittels <code class="docutils literal notranslate"><span class="pre">output=sos</span></code> die “second-order sections” aus, da mit diesen diekt über das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.sosfilt.html"><code class="docutils literal notranslate"><span class="pre">signal.sosfilt()</span></code></a> eine Filterung des Signals durchgeführt werden kann.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Beispiel: Entfernen von Signalen mittels IIR-Bandsperrfilters (Butterworth)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># Parameterinitialisierung</span>
<span class="n">bw_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Angabe der Bandbreite</span>
<span class="n">filterOrder</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>   <span class="c1"># ToDo: Ordnung des IIR-Filters</span>
<span class="n">wPass_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>      <span class="c1"># ToDo: Frequenzbereich des Sperrbands</span>

<span class="c1"># Erzeugen des Bandsperrfilters </span>
<span class="n">sos</span> <span class="o">=</span>  <span class="p">[</span><span class="o">..</span><span class="p">]</span>                              <span class="c1"># ToDo: Berechnung der &quot;second-order sections&quot; mittels signal.butter()</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H_butt</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                         <span class="c1"># ToDo: Berechnung des Frequenzgangs mittels signal.sosfreqz()</span>

<span class="c1"># Filterung </span>
<span class="n">corruptedAudioSignal_filtered</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>     <span class="c1"># ToDo: IIR-Filterung von &quot;corruptedAudioSignal&quot; mittels signal.sosfilt()</span>
<span class="n">corruptedAudioSignal_filtered_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnen Sie mittels FFT den Frequenzbereich des gefilterten Signals</span>

<span class="c1"># Graphische Darstellung</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang des Butterworth Filters mit Ordnung=</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">filterOrder</span>)
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_butt</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_filtered</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_filtered_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des Butterworth-gefilterten Signals (10. Ordnung)</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Um nun den Butterworth-Filter mit Spezifikationen zu erzeugen, soll nun der Filterentwurf mit Ordnungsselektion durchgeführt werden. Dazu wird das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.buttord.html">signal.buttord()</a> verwendet. Dessen Dämpfung soll im Sperrbereich von $fsin_Hz-bw$ bis $fsin_Hz+bw$ Hz mindestens 60 dB betragen, während die Dämpfung im Durchlassbereich (außerhalb von [$fsin_Hz-bw-10, fsin_Hz+bw+10$] Hz) innerhalb von -10 dB liegen soll.<br>
Die Bandbreite soll dabei wieder 30 Hz betragen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Aufgabe: Entfernen von Signalen mittels IIR-Bandsperrfilters (Butterworth)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># Ordnungsselektion</span>
<span class="n">bw_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Angabe der Bandbreite</span>
<span class="n">optOrder</span><span class="p">,</span> <span class="n">wPass_rad</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnung der Ordnungszahl und der Grenzfrequenzen mit signal.buttord() </span>

<span class="c1"># Filterung </span>
<span class="n">sos</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                               <span class="c1"># ToDo: Berechnung der &quot;second-order sections&quot; mittels signal.butter()</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H_butt</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>                         <span class="c1"># ToDo: Berechnung des Frequenzgangs mittels signal.sosfreqz()</span>
<span class="n">corruptedAudioSignal_filtered</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>     <span class="c1"># ToDo: IIR-Filterung von &quot;corruptedAudioSignal&quot; mittels signal.sosfilt()</span>
<span class="n">corruptedAudioSignal_filtered_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnung des Frequenzgangs mittels FFT</span>


<span class="c1"># Graphische Darstellung</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang des Butterworth Filters mit Ordnung=</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">optOrder</span>)
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_butt</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_filtered</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_filtered_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des Butterworth-gefilterten Signals (Ordnungsselektion)</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Im Titel der ersten Graphik wird die Ordnungszahl ausgegeben. Diese ist um mindestens 2 Zehnerpotenzen geringer als die des FIR-Filters. Das bedeutet, dass man für die Umsetzung des IIR-Filters viel weniger Speicherplatz und Rechenleistung benötigt, was die Anwendung des IIR-Filters in diesem Fall viel effizienter macht.</p>
</section>
<hr class="docutils" />
<section id="chebyshev-filter">
<h3>3.2 Chebyshev Filter<a class="headerlink" href="#chebyshev-filter" title="Permalink to this headline">#</a></h3>
<p>Entwerfen Sie zum Schluss noch einen Chebyshev-Filter vom Typ 2 zur Bereinigung des Audiosignals. Auch hier soll die Ordnungsselektion angewendet werden, wofür das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.cheb2ord.html"><code class="docutils literal notranslate"><span class="pre">signal.cheb2ord()</span></code></a> zur Verfügung steht.<br>
Die Bedingungen an den Filter sind wie in 3.1: Die Dämpfung soll im Sperrbereich von $fsin_Hz-bw$ bis $fsin_Hz+bw$ Hz mindestens 60 dB betragen, während die Dämpfung im Durchlassbereich (außerhalb von [$fsin_Hz-bw-10, fsin_Hz+bw+10$] Hz) innerhalb von -10 dB liegen soll.<br>
Die Bandbreite soll dabei wieder $bw = 60$ Hz betragen.</p>
<p>Für die Berechnung des Filters soll nun aber das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.cheby2.html"><code class="docutils literal notranslate"><span class="pre">signal.cheby2()</span></code></a> verwendet werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Aufgabe: Entfernen von Signalen mittels IIR-Bandsperrfilters (Chebyshev II mit Ordnungselektion)</span>
<span class="sd">&#39;&#39;&#39;</span>



<span class="c1"># Ordnungsselektion</span>
<span class="n">bw_Hz</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>               <span class="c1"># ToDo: Angabe der Bandbreite</span>
<span class="n">optOrder</span><span class="p">,</span> <span class="n">wPass_rad</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnung der Ordnungszahl und der Grenzfrequenzen mit signal.cheb2ord() </span>

<span class="c1"># Erzeugen des Bandsperrfilters </span>
<span class="n">sos</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>        <span class="c1"># ToDo: Berechnung der &quot;second-order sections&quot; mittels signal.cheby2()</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H_butt</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Berechnung des Frequenzgangs mittels signal.sosfreqz()</span>

<span class="c1"># Filterung </span>
<span class="n">corruptedAudioSignal_filtered</span> <span class="o">=</span>     <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: IIR-Filterung von &quot;s_windowed&quot; mittels signal.sosfilt()</span>
<span class="n">corruptedAudioSignal_filtered_fft</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Berechnung des Frequenzgangs mittels FFT</span>


<span class="c1"># Graphische Darstellung</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">311</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang des Chebyshev-II Filters mit Ordnung=</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">optOrder</span>)
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H_butt</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">signalLength</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">312</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Audiosignal nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zeit [s]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_s</span><span class="p">,</span> <span class="n">corruptedAudioSignal_filtered</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">313</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequenzgang nach Filterung&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequenz [rad]&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fPlot_Hz</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corruptedAudioSignal_filtered_fft</span><span class="p">[:</span><span class="n">signalLength</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Abspielen des Chebyshev-gefilterten Signals (Ordnungsselektion)</span>
<span class="n">sound</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>    <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>
<span class="n">play_obj</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span> <span class="c1"># ToDo: Abspielen von sound</span>
<span class="n">play_obj</span><span class="o">.</span><span class="n">wait_done</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Zum Schluss soll nun das bearbeitete Audiosignal gespeichert werden. Dazu kann das Objekt <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.wavfile.write.html"><code class="docutils literal notranslate"><span class="pre">wavfile.write()</span></code></a> verwendet werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Beispiel: Daten in eine wav-Datei schreiben</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># Pfad einer neuen wav-Datei bestimmen</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;data/akustik_filtered.wav&#39;</span>

<span class="c1"># Audiodaten in 16-Bit-Format konvertieren</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="o">..</span><span class="p">]</span>  <span class="c1"># ToDo: Konvertieren sie das Audiosignal in 16-Bit-Format (INT16) </span>

<span class="c1"># Audiodaten schreiben</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Speichern Sie das Audiosignal data in data_path mit fs_Hz-Frequenz ab.</span>

<span class="c1"># Testen, ob die Daten erfolgreich gespeichert wurde</span>
<span class="p">[</span><span class="o">..</span><span class="p">]</span>         <span class="c1"># ToDo: Spielen Sie die gespeicherte Datei mit z.B. playsound() ab.</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Titelbild von <a class="reference external" href="https://lda-audiotech.com/en/2018/10/30/how-to-digitize-analog-audio/">Encarni Mármol</a></p></li>
<li><p><a class="reference external" href="https://pythonbasics.org/python-play-sound/">Play sound in Python</a></p></li>
</ol>
<hr class="docutils" />
<div>Notebook erstellt von Arne-Lukas Fietkau, Yifei Li  und <a href="mailto:christoph.wagner@tu-dresden.de?Subject=Frage%20zu%20Jupyter%20Notebook%201.3%20Anwendungsbeispiel" target="_top">Christoph Wagner</a></div></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "Berni96/tud-sv",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Thema-1-Filter"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="1.2%20-%20IIR%20Filterentwurf.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">1.2 - IIR-Filterentwurf</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Thema-2-Messung%20der%20%C3%9Cbertragungsfunktion/2.1%20-%20Sweep.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.1 - Sweep</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By SHK<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>